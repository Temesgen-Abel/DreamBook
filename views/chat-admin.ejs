<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Chat</title>
  <link rel="stylesheet" href="/style.css">
  <%- include('includes/head') %>
</head>

<body>

<%- include('includes/header', { user, notifications: notifications || [] }) %>

<div class="chat-layout">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <h2>Users</h2>

    <% users.forEach(u => { %>
      <div class="user-item <%= otherUser && otherUser.id === u.id ? 'active' : '' %>">
        <a href="/chat-admin?user=<%= u.id %>"><%= u.username %></a>
      </div>
    <% }) %>
  </div>

  <!-- CHAT AREA -->
  <div class="chat-area">

    <% if (!otherUser) { %>
      <p>Select a user to begin chatting.</p>
    <% } else { %>

      <h2>Chat with <%= otherUser.username %></h2>

      <div class="messages">
        <% messages.forEach(m => { %>
          <div class="bubble <%= m.senderid == otherUser.id ? 'them' : 'me' %>">
            <strong><%= m.sendername %></strong><br>
            <%= m.message %>
          </div>
        <% }) %>
      </div>

      <form class="send-box" action="/chat-admin/<%= otherUser.id %>" method="POST">
        <textarea name="message" rows="2" placeholder="Type a message..." required></textarea>
        <button type="submit">Send</button>
      </form>

    <% } %>

  </div>

</div>

</body>
</html>

