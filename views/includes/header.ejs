<header>
  <nav class="nav">

    <!-- LOGO -->
    <a href="/" class="logo-wrapper" aria-label="DreamBook Home">
      <img src="/images/DreamBook.png" class="DreamBook-logo" alt="DreamBook logo" />
    </a>

    <!-- MOBILE MENU BUTTON -->
    <button class="menu-btn" onclick="toggleMenu()" aria-expanded="false">
      â˜°
    </button>

    <!-- NAV LINKS -->
    <div class="nav-links" id="navLinks">

      <a href="/dictionary">Dream Dictionary</a>
      <a href="/dream-realness">Dream Analyzer</a>
      <a href="/dashboard">Public Posts</a>
      <a href="/create-post">Post Your Dream</a>
      <a href="/inbox" class="highlight">Inbox</a>

      <!-- ðŸ”” Notification Dropdown -->
      <div class="notif-dropdown">
        <button id="notif-bell" onclick="toggleNotif()" aria-expanded="false">
          ðŸ”” <span id="notif-count">0</span>
        </button>

        <div class="notif-panel" id="notifPanel">
          <p class="notif-title">Notifications</p>

          <% if (notifications && notifications.length > 0) { %>
            <% notifications.forEach(n => { %>
              <div class="notif-item">
                <%= n.text %>
              </div>
            <% }) %>
          <% } else { %>
            <p class="notif-empty">No notifications yet</p>
          <% } %>
        </div>
      </div>

      <!-- Account Dropdown -->
      <div class="dropdown">
        <button class="dropbtn">Account â–¼</button>
        <div class="dropdown-content">
          <% if (user) { %>
            <a href="#">Logged in as <strong><%= user.username %></strong></a>
            <a href="/logout">Logout</a>
          <% } else { %>
            <a href="/register">Sign Up</a>
            <a href="/login">Login</a>
          <% } %>
        </div>
      </div>

    </div>
  </nav>
</header>

<script>
/* ======= MOBILE MENU TOGGLE ======= */
function toggleMenu() {
  const menu = document.getElementById("navLinks");
  const btn = document.querySelector(".menu-btn");

  menu.classList.toggle("active");

  btn.setAttribute("aria-expanded", menu.classList.contains("active"));
}

/* ======= NOTIFICATION TOGGLE ======= */
function toggleNotif() {
  const notifPanel = document.getElementById("notifPanel");
  const expanded = notifPanel.classList.toggle("open");

  document.getElementById("notif-bell")
    .setAttribute("aria-expanded", expanded);
}

/* Close notification panel if clicked outside */
document.addEventListener("click", function(e) {
  if (!e.target.closest(".notif-dropdown")) {
    document.getElementById("notifPanel").classList.remove("open");
  }
});
</script>
